---
title: "electron âœ–ï¸React âœ–ï¸TypeScriptã§Zennç”¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½œã£ã¦ã¿ã‚‹"
emoji: "âœï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [react, typescript, electron, javascript, ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³]
published: false

---

ã¿ãªã•ã‚“ã¯ã˜ã‚ã¾ã—ã¦ã€‚

æ™®æ®µã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã€ã²ã£ãã‚Šã¨phpç­‰ã‚’æ›¸ãã“ã¨ã§ã”é£¯ã‚’é£Ÿã¹ã¦ãŠã‚Šã¾ã™ã€‚
ã“ã®åº¦ã¯æµè¡Œã‚Šã®Zennã«æŠ•ç¨¿ã™ã‚‹ã¨ã„ã†ã“ã¨ã§ã€å¤§äººæ°—ã®**React**ã¨**TypeScript**ã‚’å­¦ç¿’ã™ã‚‹è¨˜äº‹ã«ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

å­¦ç¿’ã™ã‚‹ã«ã—ã¦ã‚‚Todoã‚¢ãƒ—ãƒªãªã©ã§ã¯ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¿ã¦ãšã‚¼ãƒ«ãƒ€ã‚„ãƒ”ã‚¯ãƒŸãƒ³ã«æ™‚é–“ã‚’å¥ªã‚ã‚ŒãŒã¡ãªã®ã§ã€**ä¿ºã®ä¿ºã«ã‚ˆã‚‹ä¿ºã®ãŸã‚ã®**ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½œã‚‹ã‚“ã ã£ã¦ã„ã†æ°—æŒã¡ã§æŒ‘ã‚€ã“ã¨ã«ã—ã¾ã™ã€‚


# ã¯ã˜ã‚ã«

ä»¥ä¸‹ã®gifã®ã‚ˆã†ã«Gité€£æºã—ãŸZennã®è¨˜äº‹ã‚„æœ¬ã‚’ç·¨é›†ã§ãã‚‹ãƒãƒ¼ã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚
![](/images/ezgif.com-video-to-gif.gif)

ã“ã®ã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†ã¨æ€ã£ãŸãã£ã‹ã‘ã¯ã€
- Zennã®Webã‚¨ãƒ‡ã‚£ã‚¿ã«Markdownè¨˜æ³•ã‚’æŒ¿å…¥ã™ã‚‹ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãŒãªã„ã“ã¨
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã—ãªãŒã‚‰ç·¨é›†ã§ããªã„ã“ã¨
- githubé€£æºã™ã‚‹ã¨ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒã‚ã‚“ã©ãã•ã„ã“ã¨
- ã¡ã‚‡ã†ã©TypeScriptã¨Reactã‚’å‹‰å¼·ã—ã‚ˆã†ã¨æ€ã£ã¦ãŸã“ã¨

ã§ã™ã€‚
ã“ã®èª²é¡Œã‚’å…¨ã¦è§£æ±ºã™ã‚‹ã‚¢ãƒ—ãƒªã«ã—ã‚ˆã†ã¨æ€ã£ã¦ã¾ã™ã€‚

## å‰ææ¡ä»¶
- [Zennã¨ã®GitHubãƒªãƒã‚¸ãƒˆãƒªé€£æº](https://zenn.dev/zenn/articles/connect-to-github)ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨

## å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½
æœ€ä½é™ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
- Zennã¨ã®ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚ã‚‹Zennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰è¨˜äº‹ã‚„æœ¬ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ï¼‰
- Zennãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®è‡ªå‹•ä¿å­˜
- ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆZennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª/imagesã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼‰
- ç”»åƒã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼Zennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª/imagesã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã™ã‚‹ï¼‰
- ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®è¨€èªåˆ¥ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¡¨ç¤º

## åˆ©ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [ElectronForge](https://www.electronforge.io/)
	electronã‚’ã„ã„æ„Ÿã˜ã§ç°¡å˜ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¦ãã‚Œã‚‹
- [react-simplemde-editor](https://github.com/RIP21/react-simplemde-editor)
 ã„ã„æ„Ÿã˜ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿
- [marked](https://github.com/markedjs/marked)
ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã®æ–‡å­—åˆ—ã‚’HTMLã«å¤‰æ›ã—ã¦ãã‚Œã‚‹
- [highlight.js](https://github.com/highlightjs/highlight.js)
  ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆã¤ã‘ã¦ãã‚Œã‚‹
- [mantine](https://mantine.dev/)
  Reactã®UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª
	
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
æ—©é€Ÿ[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://www.electronforge.io/templates/typescript-+-webpack-template)ã«å¾“ã„ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§Webpack,TypeScriptã‚’templateã«é¸æŠã—ã¦ã€Electron ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```
$ npm init electron-app@latest zenn-md-editor -- --template=webpack-typescript
```
ä»¥ä¸Šã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨zenn-md-editorãƒ•ã‚©ãƒ«ãƒ€ãŒã§ãã‚ãŒã‚‹ã®ã§ã€ã¨ã‚Šã‚ãˆãšå‹•ãã‹ç¢ºèªã—ã¾ã™ã€‚

```
$ cd zenn-md-editor
$ npm run start
```

ã§ãã¾ã—ãŸï¼
![](/images/screen-shot1.png)

ç¶šã„ã¦ã€tsconfig.jsonã«JSXå¤‰æ›ã®æŒ‡å®šã‚’ã—ã¾ã™ã€‚
```json:tsconfig.json
{
  "compilerOptions": {
    "target": "ES6",
    "allowJs": true,
    "module": "commonjs",
    "skipLibCheck": true,
    "esModuleInterop": true,
    "noImplicitAny": true,
    "sourceMap": true,
    "baseUrl": ".",
    "outDir": "dist",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "paths": {
      "*": ["node_modules/*"]
    },
    "jsx": "react-jsx", // è¿½åŠ 
  },
  "include": ["src/**/*"]
}
```
ã“ã‚Œã§é–‹ç™ºæº–å‚™ãŒæ•´ã£ãŸã¨ã„ã£ãŸã¨ã“ã‚ã§ã—ã‚‡ã†ã‹ã€‚
ç°¡å˜ã§ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ğŸ˜­
# ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿ã®ä½œæˆ
## åˆæœŸç”»é¢ã®è¡¨ç¤º

ã¾ãšå¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã„ã¾ã™ã€‚
```
$ npm install --save react react-dom react-simplemde-editor easymde highlight.js marked
$ npm install --save-dev @types/react @types/react-dom @types/marked
```

ç¶šã„ã¦srcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«root.tsxã¨App.tsxãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°è¦ä½œæˆã—ã¦App.tsxã‚’åˆæœŸç”»é¢ã¨ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚
- ğŸ—‚src/index.htmlã«åˆæœŸç”»é¢è¡¨ç¤ºã®ãŸã‚idã‚’è¿½è¨˜
```diff html:src/index.html
  <head>
    <meta charset="UTF-8" />
    <title>Hello World!</title>
  </head>
  <body>
-	<h1>ğŸ’– Hello World!</h1>
-  <p>Welcome to your Electron application.</p>

+    <div id="app"></div>
  </body>
```

- ğŸ—‚root.tsã§Appã‚’è¡¨ç¤º
```tsx:src/root.tsx
import { createRoot } from "react-dom/client";

import App from "./App";

function render() {
  const root = createRoot(document.getElementById("app"));
  root.render(<App />);
}

render();
```

- ğŸ—‚renderer.tsã§root.tsxã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯Webpackã§è‡ªå‹•çš„ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€"renderer" contextã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚„ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã«ã¤ã„ã¦ã¯å¾Œã»ã©ã€‚
```diff ts:renderer.ts
import './index.css';
+ import './root';

console.log('ğŸ‘‹ This message is being logged by "renderer.js", included via webpack');
```

- ğŸ—‚App.tsxç·¨é›†
```tsx:src/App.tsx
const App: React.FC = () => {
  return (
    <div>Hello World!</div>
  )
}

export default App;
```
ä¸­èº«ã¯èª¬æ˜ã™ã‚‹ã¾ã§ã‚‚ãªã„ã®ã§çœãã¾ã™ã€‚
è¡¨ç¤ºã§ãã¾ã—ãŸï¼

![](/images/screen-shot2.png)

## ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿ã®Componentä½œæˆ
ã„ã‚ˆã„ã‚ˆæœ¬ç•ªï¼ã¨è¨€ã£ã¦ã‚‚ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã ã‘ã§ã™ãŒã€ã€

srcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«componentsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€Home.tsxã¨editor/MarkdownEditor.tsxãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
Home.tsxã¯å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å‘¼ã³å‡ºã—ã€MarkdownEditor.tsxã¯ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿è‡ªä½“ã§ã™ã€‚
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã€‚
```
src
â”œâ”€ components
â”‚   â”œâ”€ editor
â”‚   â”‚   â””â”€ MarkdownEditor.tsx
â”‚   â””â”€ Home.tsx
â””â”€ App.tsx
``` 
- ğŸ—‚App.tsxç·¨é›†
```diff tsx:src/App.tsx
+ import Home from './components/Home';

const App: React.FC = () => {
  return (
-    <div>Hello World!</div>
+   <Home/>
  )
}

export default App;
```

- ğŸ—‚Home.tsxä½œæˆ
```tsx: src/components/Home.tsx
import MarkdownEditor from '../components/editor/MarkdownEditor';

const Home: React.FC = () => {
  return (
    <>
      <MarkdownEditor/>
    </>
  )
}

export default Home;
```

- ğŸ—‚MarkdownEditor.tsxä½œæˆ
```tsx:src/components/editor/MarkdownEditor.tsx
import SimpleMdeReact from "react-simplemde-editor";
import "easymde/dist/easymde.min.css";

const MarkdownEditor: React.FC = () => {
  return (
    <SimpleMdeReact id="simple-mde"/>
  );
};

export default MarkdownEditor;
```

ã“ã“ã¾ã§ã§ä¸€æ—¦è¡¨ç¤ºã—ã¦ã¿ã‚‹ã¨ã€å‹•ä½œã¯ã—ã¦ã„ã¾ã™ãŒãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

![](/images/screen-shot3.png)

ã‚¨ãƒ©ãƒ¼ã‚’è¦‹ã‚‹ã¨å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®CDNãŒCSPã§æ‹’å¦ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

è¶…ç°¡å˜ã«è¨€ã†ã¨ã€Webã‚µã‚¤ãƒˆãŒæ”»æ’ƒã•ã‚Œãªã„ã‚ˆã†ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã—ã¦ã‚ã‚‹ã®ã§ã€å¤–éƒ¨èª­ã¿è¾¼ã¿ã§è¨±å¯ã™ã‚‹ã‚‚ã®ã¯æ˜ç¤ºçš„ã«è¨±å¯ã—ã¦ã£ã¦ã“ã¨ã§ã™ã‹ã­ã€‚
â€» è©³ã—ãã¯[ã‚³ãƒãƒ©](https://developer.mozilla.org/ja/docs/Web/HTTP/CSP)

[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://www.electronjs.org/ja/docs/latest/tutorial/security)ã«è©³ã—ãè¼‰ã£ã¦ã¾ã™ãŒã€src/index.tsã‚’ç·¨é›†ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹è©²å½“ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨±å¯ã—ã¾ã™ã€‚

```diff ts:src/index.ts
-import { app, BrowserWindow } from 'electron';
+import { app, BrowserWindow, session } from 'electron';

...

- app.on('ready', createWindow);

+// ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæº–å‚™ã§ããŸå¾Œã«CSPã‚’è¨­å®š
+app.whenReady().then(() => {
+  session.defaultSession.webRequest.onHeadersReceived((details, callback) => {
+    const cspHeader = "default-src 'self' 'unsafe-eval' 'unsafe-inline' file: data: https://maxcdn.bootstrapcdn.com https://cdn.jsdelivr.net/;";
+
+    callback({
+      responseHeaders: {
+        ...details.responseHeaders,
+        'Content-Security-Policy': [cspHeader]
+      }
+    });
+  });
+
+  createWindow(); // æœ€åˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆ
+});
```

ã“ã‚Œã§ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãŒå•é¡Œãªãè¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼

# ã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
## ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
ã“ã®ã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†ã¨æ€ã£ãŸã‚­ãƒƒã‚«ã‚±ã®ä¸€ã¤ã«ã€Markdownè¨˜æ³•ã‚’æŒ¿å…¥ã™ã‚‹ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãŒæ¬²ã—ã„ã¨ã„ã†æ°—æŒã¡ãŒã‚ã£ãŸã®ã§ã€ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‹ã‚‰ã„ãã¾ã™ã€‚

SimpleMdeã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¯EasyMDEã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’propsã¨ã—ã¦æ¸¡ã™ã“ã¨ãŒã§ãã€ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[https://github.com/Ionaru/easy-markdown-editor#toolbar-icons](https://github.com/Ionaru/easy-markdown-editor#toolbar-icons)ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ä¸€è¦§ãŒè¦‹ã‚Œã‚‹ã®ã§ã€ã“ã“ã‹ã‚‰å¥½ããªã‚‚ã®ã‚’è¿½åŠ ã—ã¾ã™ã€‚

- ğŸ—‚MarkdownEditor.tsxã‚’ç·¨é›†
```diff tsx:src/components/editor/MarkdownEditor.tsx
+import { useMemo } from "react";
 import SimpleMdeReact from "react-simplemde-editor";
+import SimpleMDE from "easymde";
 import "easymde/dist/easymde.min.css";
+const toolbar: SimpleMDE.Options["toolbar"] = [
+  'bold',
+  'italic',
+  'quote',
+  'unordered-list',
+  'ordered-list',
+  'link',
+  'image',
+  'strikethrough',
+  'code',
+  'table',
+  'redo',
+  'heading',
+  'undo',
+  'clean-block',
+  'horizontal-rule',
+  'preview',
+  'side-by-side',
+  'fullscreen'
+];
 
 const MarkdownEditor: React.FC = () => {
+  const mdeOptions: SimpleMDE.Options = useMemo(() => {
+    return {
+      width: 'auto',
+      spellChecker: false,
+      toolbar
+    };
+  }, []);
+
   return (
-    <SimpleMdeReact id="simple-mde"/>
+    <SimpleMdeReact
+      id="simple-mde"
+      options={mdeOptions}/>
   );
 };
```
## ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–æ©Ÿèƒ½ã®è¿½åŠ 

SimpleMDEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–æ©Ÿèƒ½ãŒã‚ã‚‹ã®ã§ã€ãã‚Œã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
Zennãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®å®Ÿè£…æ™‚ã«ã¯ç·¨é›†ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å†…å®¹ã‚’æ›¸ãè¾¼ã¿ã¾ã™ãŒã€åŒæœŸã—ã¦ã„ãªã„å ´åˆã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ãŸã„ã®ã§ã€‚

ã“ã®ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–æ©Ÿèƒ½ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«smde_{æŒ‡å®šã—ãŸid}ã¨ã„ã†Keyã§ä¿å­˜ã—ã¦ãã‚Œã¾ã™ã€‚
ç·¨é›†1ç§’å¾Œã«ä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚
- ğŸ—‚MarkdownEditor.tsxã‚’ç·¨é›†
```diff tsx:src/components/editor/MarkdownEditor.tsx
...

+const delay = 1000;// 1ç§’å¾Œã«ä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®š
 
 const MarkdownEditor: React.FC = () => {
+  const value = localStorage.getItem('smde_saved_content') || "";// ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å€¤ã‚’ãƒãƒªãƒ¥ãƒ¼ã«ã‚»ãƒƒãƒˆ
   const mdeOptions: SimpleMDE.Options = useMemo(() => {
     return {
       width: 'auto',
       spellChecker: false,
-      toolbar
+      toolbar,
+      autosave: {
+        enabled: true,
+        uniqueId: "saved_content",
+        delay
+      },
     };
   }, []);
 
   return (
     <SimpleMdeReact
       id="simple-mde"
-      options={mdeOptions}/>
+      options={mdeOptions}
+      value={value}/>
   );
 };
```

ã“ã‚Œã§ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚å€¤ãŒä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼

## ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
ã¾ãšã¯highlight.js, marked, highlight.jsã§è‡ªåˆ†ã®å¥½ã¿ã®cssã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
https://highlightjs.org/examples

- ğŸ—‚MarkdownEditor.tsxã‚’ç·¨é›†
```diff tsx:src/components/editor/MarkdownEditor.tsx
+ import { marked } from "marked";
+ import hljs from 'highlight.js';
+ import "highlight.js/styles/base16/bright.css"; //ğŸ‘‰ https://highlightjs.org/examples
```

ç¶šã„ã¦ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã§tsx:index.tsxã®ã‚ˆã†ã«{è¨€èª}:{ãƒ•ã‚¡ã‚¤ãƒ«å}ã§å…¥åŠ›ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã®ã§ã€SimpleMDE.Optionsã®previewRenderã‚’ä½¿ã£ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã„ãã¾ã™ã€‚

previewRenderã¯ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã® Markdown ã‚’è§£æã—ã¦ HTMLã‚’è¿”ã™ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã¨ãã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

- ğŸ—‚MarkdownEditor.tsxã‚’ç·¨é›†

```diff tsx:src/components/editor/MarkdownEditor.tsx
...

+  const previewRender = (value: string): string => {
+    const renderer = new marked.Renderer();
+    renderer.code = (code, codeInfo) => {
+      const codeInfoSplit = codeInfo.split(':');
+      const lang = codeInfoSplit[0]
+      const fileName = codeInfoSplit[1];
+      const langClass = hljs.getLanguage(lang) ? lang : 'plaintext';
+      const highlightedCode = hljs.highlight(langClass, code).value;
+      const codeBlockClass = fileName === undefined ? 'code-block-no-info' : 'code-block';
+
+      let codeBlock = `<code class="hljs ${codeBlockClass} language-${langClass}">${highlightedCode}</code>`
+      if (fileName !== undefined) {
+        codeBlock = `<div class="code-info"><span>${fileName}</span></div>` + codeBlock
+      }
+      return `<pre>${codeBlock}</pre>`
+    };
+
+    return marked(value, { renderer });
+  };
+
   const mdeOptions: SimpleMDE.Options = useMemo(() => {
     return {
       width: 'auto',
       spellChecker: false,
       toolbar,
+      previewRender,
       autosave: {
         enabled: true,
         uniqueId: "saved_content",
         delay
       },
     };
-  }, []);
+  }, [previewRender]);
```

ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®è¦‹ãŸç›®ã‚‚æ•´ãˆãŸã„ã®ã¨ã€ã‚¨ãƒ‡ã‚£ã‚¿ãŒå…¨ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¦æ¬²ã—ã„ã®ã§ã€cssã‚’ç·¨é›†ã—ã¾ã™ã€‚
- ğŸ—‚index.cssã‚’ç·¨é›†
```css:src/index.css
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,
    Arial, sans-serif;
  margin: auto;
  max-width: auto;
}

.code-block{
  border-radius: 0px 0px 10px 10px
}

.code-block-no-info{
  border-radius: 10px
}

code{
  font-size: 1rem;
}

.code-info {
  display: flex;
  justify-content: space-between;
  color: #e6e6ee;
  background: #484747;
  padding: 12px;
  font-size: 12px;
  border-radius: 10px 10px 0px 0px;
}
```

ã¾ãã¾ãã„ã„æ„Ÿã˜ã€‚
![](/images/screen-shot4.png)

## ã“ã“ã¾ã§ã®MarkdownEditor.tsxã®ã‚³ãƒ¼ãƒ‰å…¨ä½“
```tsx:src/components/editor/MarkdownEditor.tsx
import { useMemo } from "react";
import SimpleMdeReact from "react-simplemde-editor";
import SimpleMDE from "easymde";
import { marked } from "marked";
import hljs from 'highlight.js';
import "easymde/dist/easymde.min.css";
import "highlight.js/styles/base16/bright.css"; //ğŸ‘‰ https://highlightjs.org/examples

const toolbar: SimpleMDE.Options["toolbar"] = [
  'bold',
  'italic',
  'quote',
  'unordered-list',
  'ordered-list',
  'link',
  'image',
  'strikethrough',
  'code',
  'table',
  'redo',
  'heading',
  'undo',
  'clean-block',
  'horizontal-rule',
  'preview',
  'side-by-side',
  'fullscreen'
];

const delay = 1000; // 1ç§’å¾Œã«ä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®š

const MarkdownEditor: React.FC = () => {
  const value = localStorage.getItem('smde_saved_content') || ""; // ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å€¤ã‚’SimpleMdeReactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®valueã¨ã—ã¦ã‚»ãƒƒãƒˆ

  const previewRender = (value: string): string => {
    const renderer = new marked.Renderer();
    renderer.code = (code, codeInfo) => {
      const codeInfoSplit = codeInfo.split(':');
      const lang = codeInfoSplit[0]
      const fileName = codeInfoSplit[1];
      const langClass = hljs.getLanguage(lang) ? lang : 'plaintext';
      const highlightedCode = hljs.highlight(langClass, code).value;
      const codeBlockClass = fileName === undefined ? 'code-block-no-info' : 'code-block';

      let codeBlock = `<code class="hljs ${codeBlockClass} language-${langClass}">${highlightedCode}</code>`
      if (fileName !== undefined) {
        codeBlock = `<div class="code-info"><span>${fileName}</span></div>` + codeBlock
      }
      return `<pre>${codeBlock}</pre>`
    };

    return marked(value, { renderer });
  };

  const mdeOptions: SimpleMDE.Options = useMemo(() => {
    return {
      width: 'auto',
      spellChecker: false,
      toolbar,
      previewRender,
      autosave: {
        enabled: true,
        uniqueId: "saved_content",
        delay
      },
    };
  }, [previewRender]);

  return (
    <SimpleMdeReact
      id="simple-mde"
      options={mdeOptions}
      value={value}/>
  );
};

export default MarkdownEditor;
```

# Zennã¨ã®é€£æºæ©Ÿèƒ½æ¦‚è¦
ã“ã“ã¾ã§ã§ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿ä½œæˆã™ã‚‹ã“ã¨ã¯ã§ããŸã®ã§ã€Zennã¨ã®é€£æºã«ã¤ã„ã¦è€ƒãˆãŸã„ã¨æ€ã„ã¾ã™ã€‚
## GitHubé€£æºã—ãŸZennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®ç¢ºèª
ã¾ãšGitHubé€£æºã—ãŸZennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

```
zennã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”œâ”€ articles
â”‚   â””â”€ è¨˜äº‹
â”œâ”€ books
â”‚   â””â”€ æœ¬ã®ã‚¹ãƒ©ãƒƒã‚°
â”‚        â””â”€ æœ¬ã®ãƒãƒ£ãƒ—ã‚¿
â””â”€images
``` 

è¨˜äº‹ã¯articlesé…ä¸‹ã«ã€booksã¯articlesã‚ˆã‚Šã‚‚ï¼‘éšå±¤æ·±ãã€booksé…ä¸‹ã«æœ¬ã®ã‚¹ãƒ©ãƒƒã‚°â†’æœ¬ã®ãƒãƒ£ãƒ—ã‚¿ã¨ãªã£ã¦ã¾ã—ãŸã€‚

ç”»åƒã«é–¢ã—ã¦ã¯imagesãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ã—ã¦ãã‚Œã¨ã®ã“ã¨ã§ã—ãŸã€‚
/imagesã¨ã„ã†ãƒ‘ã‚¹ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã§ã™ã€‚

## æ©Ÿèƒ½ã®è©³ç´°
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯æƒ³å®šé€šã‚Šãªã®ã§ã€æ©Ÿèƒ½ã®è©³ç´°ã«ã¤ã„ã¦è€ƒãˆã¾ã™ã€‚
- zennãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹ã®ç™»éŒ²
ã‚¢ãƒ—ãƒªã‹ã‚‰zennã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ç™»éŒ²ã—ã¾ã™ã€‚
ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«zennãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹æƒ…å ±ãŒãªã‘ã‚Œã°ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ã€ãã“ã‹ã‚‰ç™»éŒ²ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã¾ãŸã€ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰ã‚‚ç™»éŒ²ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®è¡¨ç¤º
  articlesã¨booksã®mdãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã«è¡¨ç¤ºã—ã¾ã™ã€‚
	å†åº¦é–‹ã„ãŸæ™‚ã«å‰å›ç·¨é›†ã—ã¦ã„ãŸãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãŸã„ã®ã§ã€ç·¨é›†ä¸­ã«ä¸­ã«é¸æŠã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã‚„ã‚¹ãƒ©ãƒƒã‚°åã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã—ã¾ã™ã€‚
	ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã“ã‚“ãªæ„Ÿã˜

![](/images/screen-shot5.png =250x)

- ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨ä¿å­˜
ãƒ•ãƒ«ãƒ‘ã‚¹ã¨é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã•ãˆã‚ã‹ã‚Œã°ã€node.jsã§ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿ã‚„èª­ã¿è¾¼ã¿ã¯å¯èƒ½ãªã®ã§ã€ç°¡å˜ã‹ã¨æ€ã„ã¾ã™ã€‚

- ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯imagesãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ã—ã¦ã¨ã®ã“ã¨ãªã®ã§ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã®ã¾ã¾imagesãƒ•ã‚©ãƒ«ãƒ€ã«ã‚³ãƒ”ãƒ¼ã—ã¦é…ç½®ã™ã‚‹ã®ã¿ã¨ã—ã¾ã™ã€‚
- ç”»åƒã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼/images/xxxã¨å…¥åŠ›ã•ã‚ŒãŸãƒ‘ã‚¹ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«file://ãƒ•ãƒ«ãƒ‘ã‚¹/imagesã«æ›¸ãæ›ãˆã¦è¡¨ç¤ºã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«å•é¡Œã‚ã‚Šãã†ã§ã™ãŒã€è‡ªåˆ†ã§ä½¿ã†ã ã‘ãªã®ã§ã€‚

# Zennã¨ã®é€£æºæ©Ÿèƒ½ã®å®Ÿè£…
é•·ã„è¨˜äº‹ã«ãªã‚Šãã†ãªã®ã§ã€è©³ç´°ã¯ãªã‚‹ã¹ãå‰²æ„›ã—ãªãŒã‚‰é€²ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã€‚

### mantineã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚„ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ä¸€ã‹ã‚‰ä½œã‚‹ã®ã¯é¢å€’ãªã®ã§ã€Reactã®UIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹mantineã‚’åˆ©ç”¨ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚
ã¨ã¦ã‚‚ä½¿ã„ã‚„ã™ã‹ã£ãŸã®ã§ã€ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ï¼
https://mantine.dev/

```
$ npm install @mantine/core @mantine/hooks @emotion/react
$ npm install @tabler/icons-react
```

### ipcMainã¨ipcRendererã«ã¤ã„ã¦
electronã¯ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã¨ã„ã†äºŒã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚
ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ¶å¾¡ã€ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã¯ç”»é¢ã‚’æ‹…å½“ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚

ã–ã£ãã‚Šèª¬æ˜ã§ã™ã„ã¾ã›ã‚“ãŒã€ä»Šã¾ã§æ›¸ã„ã¦ããŸã®ã¯ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã§ã€node.jsãŒä½¿ãˆã¾ã›ã‚“ã€‚
node.jsã§ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚„æ›¸ãè¾¼ã¿ã‚’ã—ãŸã„ã‚ã‘ãªã®ã§ã€ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚
APIé€šä¿¡ã¿ãŸã„ãªã‚‚ã‚“ã§ã™ã‹ã­ã€‚

## Zennã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—ã™ã‚‹
ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã«ç·¨é›†ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã—ãŸã„ã®ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### preloadã‚¹ã‚¯ãƒªãƒ—ãƒˆã«APIã‚’å…¬é–‹
ã¾ãšpreloadã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã®é–“ã§éåŒæœŸã®é€šä¿¡ã‚’è¡Œã†APIã‚’å…¬é–‹ã—ã¾ã™ã€‚
preloadã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹å†…ã§å®Ÿè¡Œã•ã‚Œpreloadã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§å®šç¾©ã•ã‚ŒãŸé–¢æ•°ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å®‰å…¨ã«å…¬é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
https://www.electronjs.org/docs/latest/tutorial/process-model#preload-scripts

- ğŸ—‚src/preload.tsã‚’ç·¨é›†ã—ã¾ã™ã€‚
```ts:src/preload.ts
// See the Electron documentation for details on how to use preload scripts:
// https://www.electronjs.org/docs/latest/tutorial/process-model#preload-scripts
import { contextBridge, ipcRenderer } from 'electron';
contextBridge.exposeInMainWorld(
  'api', {
    syncWithZenn: (zennDirPath: string) => ipcRenderer.invoke('sync-with-zenn', {zennDirPath}),
  }
)
```

apiã¨ã„ã†ã€`api`ã¨ã„ã†åå‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€`syncWithZenn`ã¨ã„ã†é–¢æ•°ã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦æŒãŸã›ã¾ã—ãŸã€‚
ã“ã‚Œã§ã€ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰window.api.syncWithZenn(zennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹)ã§ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã«é€šä¿¡ã§ãã¾ã™ã€‚

### å®Ÿéš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹å‡¦ç†
ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã§ã€å®Ÿéš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã®å®Ÿè£…ã‚’ã—ã¾ã™ã€‚
backgroundãƒ•ã‚©ãƒ«ãƒ€ã«index.tsã¨zenn.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```
src
â”” background
	â”œâ”€ index.ts
	â””â”€ zenn.ts
``` 

- ğŸ—‚zenn.tsä½œæˆ
syncWithZenné–¢æ•°ã®ä¸­èº«ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
ipcMain.handleã§ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã¾ã™ã€‚
zennãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’å¼•æ•°ã«å—ã‘å–ã‚Šfsã§ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚’è¡Œãªã£ã¦ã¾ã™ã€‚
```ts:src/background/zenn.ts
import fs from 'fs';
import path from 'path';

export function syncWithZenn (ipcMain: Electron.IpcMain) {
  ipcMain.handle('sync-with-zenn', async (e, {zennDirPath}) => {
    if (!fs.existsSync(zennDirPath)) throw new Error('no-content');

    let articles = {};
    if (fs.existsSync(path.join(zennDirPath, 'articles'))) {
      articles = fs.readdirSync(path.join(zennDirPath, 'articles')).filter(file => file.endsWith('.md'));
    }

    let books = {};
    if (fs.existsSync(path.join(zennDirPath, 'books'))) {
      const booksDirs = fs.readdirSync(path.join(zennDirPath, 'books')).filter(file => {
        const filePath = path.join(zennDirPath, 'books', file);
        const stats = fs.statSync(filePath);

        return stats.isDirectory();
      });

      books = booksDirs.map((dirName) => {
        const bookfiles = fs.readdirSync(path.join(zennDirPath, 'books', dirName)).filter(file => file.endsWith('.md'));
        return {
          bookName: dirName,
          files: bookfiles
        }
      })
    }

    if (!Object.keys(articles).length && !Object.keys(books).length) {
      throw new Error('no');
    }

    return {
      articles: articles,
      books: books
    }
  })
}
```

- ğŸ—‚index.tsä½œæˆ
ã“ã¡ã‚‰ã¯å…ˆã»ã©ä½œã£ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚
```ts:src/background/index.ts
import { ipcMain } from 'electron'
import { syncWithZenn } from './zenn'
export function initIpcMain () {
  syncWithZenn(ipcMain)
}
```

- ğŸ—‚å‹ã‚’ç®¡ç†ã™ã‚‹zennTypes.tsã®ä½œæˆ
å‹ã‚’å®šç¾©ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸæ–¹ãŒã„ã„ãªã¨æ€ã£ãŸã®ã§ä½œã£ãŸã‚“ã§ã™ãŒã€ã©ã†ãªã‚“ã§ã™ã‹ã­ï¼ŸTypeScriptã‚‚ã»ã¨ã‚“ã©è§¦ã£ãŸã“ã¨ãªã„ã®ã§ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã„ãŸã ã‘ãŸã‚‰å¬‰ã—ã„ã§ã™ãŒã€‚ã€‚
```ts:src/types/zennTypes.ts
type Book = {
  bookName: string;
  files: Array<string>;
};
export type zennType = {
  zennDirPath: string;
  fileNames: {
    articles: Array<string>,
    books: Array<Book>
  };
  setZennDirPath: (zennDirPath: string) => void;
};
```
- ğŸ—‚src/index.tsç·¨é›†
src/background/index.tsã§å®šç¾©ã—ãŸã„initIpcMainã‚’createWindowå†…ã§å‘¼ã³å‡ºã—ã€IPCé€šä¿¡ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
ãŸã ã€ã“ã‚Œã ã¨ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹å´ã‚’ç·¨é›†ã—ãŸéš›ã«ã€æ¯å›ç«‹ã¡ä¸Šã’ç›´ã•ãªã„ã¨å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚
çš†ã•ã‚“ã©ã†ã—ã¦ã‚‹ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ã¨ã‚Šã‚ãˆãšçªãé€²ã¿ã¾ã™ãŒã€ã€
```diff ts:src/index.ts
import { app, BrowserWindow, session } from 'electron';
+ import { initIpcMain } from './background/index';
+ import { zennType } from './types/zennTypes';
// This allows TypeScript to pick up the magic constants that's auto-generated by Forge's Webpack
// plugin that tells the Electron app where to look for the Webpack-bundled app code (depending on
// whether you're running in development or production).
declare const MAIN_WINDOW_WEBPACK_ENTRY: string;
declare const MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY: string;
+ declare global {
+  interface Window {
+     api: {
+     syncWithZenn: (zennDirPath: string) => Promise<zennType['fileNames']>;
+     };
+  }
+ }


// Handle creating/removing shortcuts on Windows when installing/uninstalling.
if (require('electron-squirrel-startup')) {
  app.quit();
}

const createWindow = (): void => {
  // Create the browser window.
  const mainWindow = new BrowserWindow({
    height: 800,
    width: 1200,
    webPreferences: {
      preload: MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY,
    },
  });

  // and load the index.html of the app.
  mainWindow.loadURL(MAIN_WINDOW_WEBPACK_ENTRY);

  // Open the DevTools.
  mainWindow.webContents.openDevTools();
+ initIpcMain();
};
```

### Contextã®ä½œæˆ
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿéš›ã«å–å¾—ã™ã‚‹å‡¦ç†ã¯å®Ÿè£…ã§ããŸã®ã§ã€ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹å´ã‹ã‚‰å‘¼ã³å‡ºã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚„çŠ¶æ…‹ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§å…±æœ‰ã—ãŸã„ã®ã§ã€Contextã‚’ä½œæˆã—ã¾ã™ã€‚
Reactã®Contextã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§ãƒ‡ãƒ¼ã‚¿ãƒ»çŠ¶æ…‹ç®¡ç†ã‚’å…±æœ‰ã§ãã‚‹ä»•çµ„ã¿ã¿ãŸã„ã§ã™ã€‚
Reactã‚„Vueã‚’å‹‰å¼·ã—ã¦ã„ã‚‹ã¨ã€ã‚ˆãè¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‹å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‹å‡ºã¦ãã¾ã™ãŒã€å½¢è¦‹ã®ã‚ˆã†ã«å­ã‚„å­«ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã•ãªãã¦ã‚‚ã€ä¸€æ—ã¿ã‚“ãªã§ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã§ãã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚

ã§ã¯æ—©é€ŸContextãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
src/contexts/ZennContext.tsxãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€çŠ¶æ…‹ç®¡ç†ã‚’ä»»ã›ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

â€» const [zennDirPath, setZennDirPath] = useState<zennType['zennDirPath']>('{Zennãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹}');
ã®éƒ¨åˆ†ã¯è‡ªåˆ†ã®Zennã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
```tsx:src/contexts/ZennContext.tsx
import { createContext, useContext, useState, useEffect } from 'react';
import { zennType } from '../types/zennTypes';

const ZennContentContext = createContext<zennType | undefined>(undefined);

export const useZennContentContext = () => {
  return useContext(ZennContentContext);
}

export const ZennContentProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [fileNames, setFileNames] = useState({ articles: [], books: [] });

  const [zennDirPath, setZennDirPath] = useState<zennType['zennDirPath']>('{Zennãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ãƒ«ãƒ‘ã‚¹}');

  const syncWithZenn = async () => {
    try {
      const files = await window.api.syncWithZenn(zennDirPath);
      setFileNames(files);
    } catch (error) {
      alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ')
    }
  };

  useEffect(() => {
    syncWithZenn();
  }, []);

  return (
    <ZennContentContext.Provider value={{
      fileNames,
      zennDirPath,
      setZennDirPath
      }}>
      {children}
    </ZennContentContext.Provider>
  );
}
```
context.Providerä»¥ä¸‹ã§å‘¼ã³å‡ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å…¨ã¦useContextã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã¿ãŸã„ã€‚
ä¾¿åˆ©ã§ã™ã­ã€‚
å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å…±æœ‰ã—ãŸã„ã®ã§ã€App.tsxã§Homeã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ZennContentProviderã§å›²ã¿ã¾ã™ã€‚

```tsx:src/App.tsx
import Home from './components/Home';
import { ZennContentProvider } from './contexts/ZennContext';

const App: React.FC = () => {
  return (
    <ZennContentProvider>
      <Home/>
    </ZennContentProvider>
  )
}

export default App;
```

## ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®ä½œæˆ
ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
UIã«é–¢ã—ã¦ã¯ã»ã¨ã‚“ã©ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã¾ã™ã€‚
https://ui.mantine.dev/category/navbars#navbar-nested
componentsé…ä¸‹ã«navigationãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã™ã€‚

```
src
â”” components
	â”” navigation
		â”œâ”€ LinksGroup.tsx
		â””â”€ Navbar.tsx
``` 

- ğŸ—‚Navbar.tsxã®ä½œæˆ
```tsx:src/components/Navbar.tsx
import { Navbar, ScrollArea, createStyles } from '@mantine/core';
import { IconNotes, IconBook } from '@tabler/icons-react';
import LinksGroup from './LinksGroup';
import { useZennContentContext } from '../../contexts/ZennContext';

const useStyles = createStyles((theme) => ({
  navbar: {
    backgroundColor: theme.colorScheme === 'dark' ? theme.colors.dark[6] : theme.white,
    paddingBottom: 0,
  },

  links: {
    marginLeft: `calc(${theme.spacing.md} * -1)`,
    marginRight: `calc(${theme.spacing.md} * -1)`,
  },

  linksInner: {
    paddingTop: theme.spacing.xl,
    paddingBottom: theme.spacing.xl,
  },
}));

const NavbarNested: React.FC = () =>  {
  const { fileNames } = useZennContentContext();
  const { classes } = useStyles();

  const articleLinks = fileNames.articles.map((article) => {
    return (
      {label: article}
    )
  })

  const booksMockData = fileNames.books.map((book) => {
    const bookLinks = book.files.map((file) => {
      return ({label: file})
    })
    return (
      {
        label: book.bookName,
        icon: IconBook,
        initiallyOpened: false,
        links: bookLinks
      }
    )
  })
  const mockdata = [
    {
      label: 'articles',
      icon: IconNotes,
      initiallyOpened: true,
      links: articleLinks
    },
    ...booksMockData
  ]

  const links = mockdata.map((item) => <LinksGroup {...item} key={item.label} />);

  return (
    <Navbar height={800} p="md" className={classes.navbar}>
      <Navbar.Section grow className={classes.links} component={ScrollArea}>
        <div className={classes.linksInner}>{links}</div>
      </Navbar.Section>
    </Navbar>
  );
}

export default NavbarNested;
```

- ğŸ—‚LinksGroup.tsxã®ä½œæˆ
UIä¸Šã§é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«åã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’å–å¾—ã™ã‚‹éš›ã«ä½¿ã†ã®ã§ã€selectedFileã¨ã—ã¦Contextã«ã‚»ãƒƒãƒˆã—ã¦ã¾ã™ã€‚
ã¾ãŸã€ãƒªãƒ­ãƒ¼ãƒ‰ãªã©å†åº¦é–‹ã„ãŸæ™‚ã«å‰å›é–‹ã„ã¦ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã—ãŸã„ã®ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚‚ç™»éŒ²ã—ã¦ã¾ã™ã€‚
```tsx:src/components/LinksGroup.tsx
import { useState } from 'react';
import {
  Group,
  Box,
  Collapse,
  ThemeIcon,
  Text,
  UnstyledButton,
  createStyles,
  rem,
} from '@mantine/core';
import { TablerIconsProps, IconChevronLeft, IconChevronRight } from '@tabler/icons-react';
import { useZennContentContext } from '../../contexts/ZennContext';

const useStyles = createStyles((theme) => ({
  control: {
    fontWeight: 500,
    display: 'block',
    width: '100%',
    padding: `${theme.spacing.xs} ${theme.spacing.md}`,
    color: theme.colorScheme === 'dark' ? theme.colors.dark[0] : theme.black,
    fontSize: theme.fontSizes.sm,

    '&:hover': {
      backgroundColor: theme.colorScheme === 'dark' ? theme.colors.dark[7] : theme.colors.gray[0],
      color: theme.colorScheme === 'dark' ? theme.white : theme.black,
    },
  },

  link: {
    fontWeight: 500,
    display: 'block',
    textDecoration: 'none',
    padding: `${theme.spacing.xs} ${theme.spacing.md}`,
    paddingLeft: rem(31),
    marginLeft: rem(30),
    fontSize: theme.fontSizes.sm,
    color: theme.colorScheme === 'dark' ? theme.colors.dark[0] : theme.colors.gray[7],
    borderLeft: `${rem(1)} solid ${
      theme.colorScheme === 'dark' ? theme.colors.dark[4] : theme.colors.gray[3]
    }`,

    '&:hover': {
      backgroundColor: theme.colorScheme === 'dark' ? theme.colors.dark[7] : theme.colors.gray[0],
      color: theme.colorScheme === 'dark' ? theme.white : theme.black,
      cursor: 'pointer'
    },
  },
  selectedLink: {
    backgroundColor: theme.colorScheme === 'dark' ? theme.colors.dark[7] : theme.colors.gray[0],
    color: theme.fn.variant({ variant: 'light', color: theme.primaryColor }).color,
    cursor: 'pointer',
  },
  resetLink: {
    backgroundColor: 'transparent',
    color: theme.colorScheme === 'dark' ? theme.colors.gray[7] : theme.colors.gray[7],
    cursor: 'pointer',
  },
  chevron: {
    transition: 'transform 200ms ease',
  },
}));

type LinksGroupProps = {
  icon: React.FC<TablerIconsProps>;
  label: string;
  initiallyOpened?: boolean;
  links?: { label: string;}[];
};

const LinksGroup: React.FC<LinksGroupProps> = ({ icon: Icon, initiallyOpened, label, links }) => {
  const { classes, theme } = useStyles();
  const { selectedFile, setSelectedFile } = useZennContentContext();
  const hasLinks = Array.isArray(links);

  let isOpend = false;
  (hasLinks ? links : []).forEach((link) => {
    if (link.label === selectedFile.file && label === selectedFile.label) {
      isOpend = true;
    }
  })

  const [opened, setOpened] = useState(isOpend || initiallyOpened);

  const ChevronIcon = theme.dir === 'ltr' ? IconChevronRight : IconChevronLeft;

  const selectFile = (label: string, file: string) => {
    setSelectedFile({label, file});
    localStorage.setItem('selected_file', file)
    localStorage.setItem('selected_label', label)
  }

  const items = (hasLinks ? links : []).map((link) => (
    <Text
      className={`${classes.link} ${(link.label === selectedFile.file && label === selectedFile.label) ? classes.selectedLink : ''}`}
      key={link.label}
      onClick={() => {
        selectFile(label, link.label)
      }}
    >
      {link.label}
    </Text>
  ));

  return (
    <>
      <UnstyledButton onClick={() => setOpened((o) => !o)} className={classes.control}>
        <Group position="apart" spacing={0}>
          <Box sx={{ display: 'flex', alignItems: 'center' }}>
            <ThemeIcon variant="light" size={30}>
              <Icon size="1.1rem" />
            </ThemeIcon>
            <Box ml="md">{label}</Box>
          </Box>
          {hasLinks && (
            <ChevronIcon
              className={classes.chevron}
              size="1rem"
              stroke={1.5}
              style={{
                transform: opened ? `rotate(${theme.dir === 'rtl' ? -90 : 90}deg)` : 'none',
              }}
            />
          )}
        </Group>
      </UnstyledButton>
      {hasLinks ? <Collapse in={opened}>{items}</Collapse> : null}
    </>
  );
}

export default LinksGroup;
```
- ğŸ—‚zennTypes.tsã®ç·¨é›†
```diff ts:src/types/zennTypes.ts
type Book = {
  bookName: string;
  files: Array<string>;
};
export type zennType = {
  zennDirPath: string;
  fileNames: {
    articles: Array<string>,
    books: Array<Book>
  };
+  selectedFile: {
+    label: string;
+    file: string;
+  };
+  setSelectedFile: (selected: { label: string, file: string }) => void;
  setZennDirPath: (zennDirPath: string) => void;
};
```
- ğŸ—‚ZennContext.tsxã®ç·¨é›†
```diff tsx:src/contexts/ZennContext.tsx
...
  const [fileNames, setFileNames] = useState({ articles: [], books: [] });

+ const [selectedFile, setSelectedFile] = useState<zennType['selectedFile']>({
+    label: localStorage.getItem('selected_label') || '',
+    file: localStorage.getItem('selected_file') || '',
+  });

...
return (
    <ZennContentContext.Provider value={{
      fileNames,
      zennDirPath,
+     selectedFile,
      setZennDirPath,
+     setSelectedFile
      }}>
      {children}
    </ZennContentContext.Provider>
```

- ğŸ—‚Home.tsxã®ç·¨é›†
```diff tsx:src/components/Home.tsx
 import MarkdownEditor from '../components/editor/MarkdownEditor';
+import NavbarNested from '../components/navigation/Navbar';
 
 const Home: React.FC = () => {
   return (
     <>
-      <MarkdownEditor/>
+      <div style={{display: 'flex'}}>
+        <div style={{width: '25%'}}>
+          <NavbarNested/>
+        </div>
+        <div style={{width: '75%'}}>
+          <MarkdownEditor/>
+        </div>
+      </div>
     </>
   )
 }
```

